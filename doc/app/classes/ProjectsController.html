<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>Class: ProjectsController</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Script-Type" content="text/javascript" />
  <link rel="stylesheet" href=".././rdoc-style.css" type="text/css" media="screen" />
  <script type="text/javascript">
  // <![CDATA[

  function popupCode( url ) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }

  function toggleCode( id ) {
    if ( document.getElementById )
      elem = document.getElementById( id );
    else if ( document.all )
      elem = eval( "document.all." + id );
    else
      return false;

    elemStyle = elem.style;
    
    if ( elemStyle.display != "block" ) {
      elemStyle.display = "block"
    } else {
      elemStyle.display = "none"
    }

    return true;
  }
  
  // Make codeblocks hidden by default
  document.writeln( "<style type=\"text/css\">div.method-source-code { display: none }</style>" )
  
  // ]]>
  </script>

</head>
<body>



    <div id="classHeader">
        <table class="header-table">
        <tr class="top-aligned-row">
          <td><strong>Class</strong></td>
          <td class="class-name-in-header">ProjectsController</td>
        </tr>
        <tr class="top-aligned-row">
            <td><strong>In:</strong></td>
            <td>
                <a href="../files/app/controllers/projects_controller_rb.html">
                app/controllers/projects_controller.rb
                </a>
        <br />
            </td>
        </tr>

        <tr class="top-aligned-row">
            <td><strong>Parent:</strong></td>
            <td>
                <a href="ApplicationController.html">
                ApplicationController
               </a>
            </td>
        </tr>
        </table>
    </div>
  <!-- banner header -->

  <div id="bodyContent">



  <div id="contextContent">

    <div id="description">
      <p>
redMine - project management software Copyright (C) 2006-2007 Jean-Philippe
Lang
</p>
<p>
This program is free software; you can redistribute it and/or modify it
under the terms of the GNU General Public License as published by the Free
Software Foundation; either version 2 of the License, or (at your option)
any later version.
</p>
<p>
This program is distributed in the hope that it will be useful, but WITHOUT
ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for
more details.
</p>
<p>
You should have received a <a
href="ProjectsController.html#M000410">copy</a> of the GNU General Public
License along with this program; if not, write to the Free Software
Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301,
USA.
</p>

    </div>


   </div>

    <div id="method-list">
      <h3 class="section-bar">Methods</h3>

      <div class="name-list">
      <a href="#M000424">activity</a>&nbsp;&nbsp;
      <a href="#M000409">add</a>&nbsp;&nbsp;
      <a href="#M000420">add_file</a>&nbsp;&nbsp;
      <a href="#M000418">add_issue_category</a>&nbsp;&nbsp;
      <a href="#M000419">add_version</a>&nbsp;&nbsp;
      <a href="#M000415">archive</a>&nbsp;&nbsp;
      <a href="#M000422">changelog</a>&nbsp;&nbsp;
      <a href="#M000410">copy</a>&nbsp;&nbsp;
      <a href="#M000417">destroy</a>&nbsp;&nbsp;
      <a href="#M000413">edit</a>&nbsp;&nbsp;
      <a href="#M000408">index</a>&nbsp;&nbsp;
      <a href="#M000421">list_files</a>&nbsp;&nbsp;
      <a href="#M000414">modules</a>&nbsp;&nbsp;
      <a href="#M000423">roadmap</a>&nbsp;&nbsp;
      <a href="#M000412">settings</a>&nbsp;&nbsp;
      <a href="#M000411">show</a>&nbsp;&nbsp;
      <a href="#M000416">unarchive</a>&nbsp;&nbsp;
      </div>
    </div>

  </div>


    <!-- if includes -->
    <div id="includes">
      <h3 class="section-bar">Included Modules</h3>

      <div id="includes-list">
        <span class="include-name"><a href="SortHelper.html">SortHelper</a></span>
        <span class="include-name"><a href="CustomFieldsHelper.html">CustomFieldsHelper</a></span>
        <span class="include-name"><a href="QueriesHelper.html">QueriesHelper</a></span>
        <span class="include-name"><a href="RepositoriesHelper.html">RepositoriesHelper</a></span>
        <span class="include-name"><a href="ProjectsHelper.html">ProjectsHelper</a></span>
      </div>
    </div>

    <div id="section">





      


    <!-- if method_list -->
    <div id="methods">
      <h3 class="section-bar">Public Instance methods</h3>

      <div id="method-M000424" class="method-detail">
        <a name="M000424"></a>

        <div class="method-heading">
          <a href="#M000424" class="method-signature">
          <span class="method-name">activity</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000424-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000424-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/projects_controller.rb, line 261</span>
261:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">activity</span>
262:     <span class="ruby-ivar">@days</span> = <span class="ruby-constant">Setting</span>.<span class="ruby-identifier">activity_days_default</span>.<span class="ruby-identifier">to_i</span>
263:     
264:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:from</span>]
265:       <span class="ruby-keyword kw">begin</span>; <span class="ruby-ivar">@date_to</span> = <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:from</span>].<span class="ruby-identifier">to_date</span> <span class="ruby-operator">+</span> <span class="ruby-value">1</span>; <span class="ruby-keyword kw">rescue</span>; <span class="ruby-keyword kw">end</span>
266:     <span class="ruby-keyword kw">end</span>
267: 
268:     <span class="ruby-ivar">@date_to</span> <span class="ruby-operator">||=</span> <span class="ruby-constant">Date</span>.<span class="ruby-identifier">today</span> <span class="ruby-operator">+</span> <span class="ruby-value">1</span>
269:     <span class="ruby-ivar">@date_from</span> = <span class="ruby-ivar">@date_to</span> <span class="ruby-operator">-</span> <span class="ruby-ivar">@days</span>
270:     <span class="ruby-ivar">@with_subprojects</span> = <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:with_subprojects</span>].<span class="ruby-identifier">nil?</span> <span class="ruby-value">? </span><span class="ruby-constant">Setting</span>.<span class="ruby-identifier">display_subprojects_issues?</span> <span class="ruby-operator">:</span> (<span class="ruby-identifier">params</span>[<span class="ruby-identifier">:with_subprojects</span>] <span class="ruby-operator">==</span> <span class="ruby-value str">'1'</span>)
271:     <span class="ruby-ivar">@author</span> = (<span class="ruby-identifier">params</span>[<span class="ruby-identifier">:user_id</span>].<span class="ruby-identifier">blank?</span> <span class="ruby-value">? </span><span class="ruby-keyword kw">nil</span> <span class="ruby-operator">:</span> <span class="ruby-constant">User</span>.<span class="ruby-identifier">active</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">params</span>[<span class="ruby-identifier">:user_id</span>]))
272:     
273:     <span class="ruby-ivar">@activity</span> = <span class="ruby-constant">Redmine</span><span class="ruby-operator">::</span><span class="ruby-constant">Activity</span><span class="ruby-operator">::</span><span class="ruby-constant">Fetcher</span>.<span class="ruby-identifier">new</span>(<span class="ruby-constant">User</span>.<span class="ruby-identifier">current</span>, <span class="ruby-identifier">:project</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@project</span>, 
274:                                                              <span class="ruby-identifier">:with_subprojects</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@with_subprojects</span>,
275:                                                              <span class="ruby-identifier">:author</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@author</span>)
276:     <span class="ruby-ivar">@activity</span>.<span class="ruby-identifier">scope_select</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">t</span><span class="ruby-operator">|</span> <span class="ruby-operator">!</span><span class="ruby-identifier">params</span>[<span class="ruby-node">&quot;show_#{t}&quot;</span>].<span class="ruby-identifier">nil?</span>}
277:     <span class="ruby-ivar">@activity</span>.<span class="ruby-identifier">scope</span> = (<span class="ruby-ivar">@author</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-value">? </span><span class="ruby-operator">:</span><span class="ruby-identifier">default</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">:all</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@activity</span>.<span class="ruby-identifier">scope</span>.<span class="ruby-identifier">empty?</span>
278: 
279:     <span class="ruby-identifier">events</span> = <span class="ruby-ivar">@activity</span>.<span class="ruby-identifier">events</span>(<span class="ruby-ivar">@date_from</span>, <span class="ruby-ivar">@date_to</span>)
280:     
281:     <span class="ruby-identifier">respond_to</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">format</span><span class="ruby-operator">|</span>
282:       <span class="ruby-identifier">format</span>.<span class="ruby-identifier">html</span> { 
283:         <span class="ruby-ivar">@events_by_day</span> = <span class="ruby-identifier">events</span>.<span class="ruby-identifier">group_by</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">:event_date</span>)
284:         <span class="ruby-identifier">render</span> <span class="ruby-identifier">:layout</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">false</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">request</span>.<span class="ruby-identifier">xhr?</span>
285:       }
286:       <span class="ruby-identifier">format</span>.<span class="ruby-identifier">atom</span> {
287:         <span class="ruby-identifier">title</span> = <span class="ruby-identifier">l</span>(<span class="ruby-identifier">:label_activity</span>)
288:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@author</span>
289:           <span class="ruby-identifier">title</span> = <span class="ruby-ivar">@author</span>.<span class="ruby-identifier">name</span>
290:         <span class="ruby-keyword kw">elsif</span> <span class="ruby-ivar">@activity</span>.<span class="ruby-identifier">scope</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">==</span> <span class="ruby-value">1</span>
291:           <span class="ruby-identifier">title</span> = <span class="ruby-identifier">l</span>(<span class="ruby-node">&quot;label_#{@activity.scope.first.singularize}_plural&quot;</span>)
292:         <span class="ruby-keyword kw">end</span>
293:         <span class="ruby-identifier">render_feed</span>(<span class="ruby-identifier">events</span>, <span class="ruby-identifier">:title</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-node">&quot;#{@project || Setting.app_title}: #{title}&quot;</span>)
294:       }
295:     <span class="ruby-keyword kw">end</span>
296:     
297:   <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">RecordNotFound</span>
298:     <span class="ruby-identifier">render_404</span>
299:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000409" class="method-detail">
        <a name="M000409"></a>

        <div class="method-heading">
          <a href="#M000409" class="method-signature">
          <span class="method-name">add</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Add a new project
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000409-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000409-source">
<pre>
    <span class="ruby-comment cmt"># File app/controllers/projects_controller.rb, line 66</span>
66:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">add</span>
67:     <span class="ruby-ivar">@issue_custom_fields</span> = <span class="ruby-constant">IssueCustomField</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>, <span class="ruby-identifier">:order</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-node">&quot;#{CustomField.table_name}.position&quot;</span>)
68:     <span class="ruby-ivar">@trackers</span> = <span class="ruby-constant">Tracker</span>.<span class="ruby-identifier">all</span>
69:     <span class="ruby-ivar">@project</span> = <span class="ruby-constant">Project</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">params</span>[<span class="ruby-identifier">:project</span>])
70:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">request</span>.<span class="ruby-identifier">get?</span>
71:       <span class="ruby-ivar">@project</span>.<span class="ruby-identifier">identifier</span> = <span class="ruby-constant">Project</span>.<span class="ruby-identifier">next_identifier</span> <span class="ruby-keyword kw">if</span> <span class="ruby-constant">Setting</span>.<span class="ruby-identifier">sequential_project_identifiers?</span>
72:       <span class="ruby-ivar">@project</span>.<span class="ruby-identifier">trackers</span> = <span class="ruby-constant">Tracker</span>.<span class="ruby-identifier">all</span>
73:       <span class="ruby-ivar">@project</span>.<span class="ruby-identifier">is_public</span> = <span class="ruby-constant">Setting</span>.<span class="ruby-identifier">default_projects_public?</span>
74:       <span class="ruby-ivar">@project</span>.<span class="ruby-identifier">enabled_module_names</span> = <span class="ruby-constant">Redmine</span><span class="ruby-operator">::</span><span class="ruby-constant">AccessControl</span>.<span class="ruby-identifier">available_project_modules</span>
75:     <span class="ruby-keyword kw">else</span>
76:       <span class="ruby-ivar">@project</span>.<span class="ruby-identifier">enabled_module_names</span> = <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:enabled_modules</span>]
77:       <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@project</span>.<span class="ruby-identifier">save</span>
78:         <span class="ruby-ivar">@project</span>.<span class="ruby-identifier">set_parent!</span>(<span class="ruby-identifier">params</span>[<span class="ruby-identifier">:project</span>][<span class="ruby-value str">'parent_id'</span>]) <span class="ruby-keyword kw">if</span> <span class="ruby-constant">User</span>.<span class="ruby-identifier">current</span>.<span class="ruby-identifier">admin?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:project</span>].<span class="ruby-identifier">has_key?</span>(<span class="ruby-value str">'parent_id'</span>)
79:         <span class="ruby-comment cmt"># Add current user as a project member if he is not admin</span>
80:         <span class="ruby-keyword kw">unless</span> <span class="ruby-constant">User</span>.<span class="ruby-identifier">current</span>.<span class="ruby-identifier">admin?</span>
81:           <span class="ruby-identifier">r</span> = <span class="ruby-constant">Role</span>.<span class="ruby-identifier">givable</span>.<span class="ruby-identifier">find_by_id</span>(<span class="ruby-constant">Setting</span>.<span class="ruby-identifier">new_project_user_role_id</span>.<span class="ruby-identifier">to_i</span>) <span class="ruby-operator">||</span> <span class="ruby-constant">Role</span>.<span class="ruby-identifier">givable</span>.<span class="ruby-identifier">first</span>
82:           <span class="ruby-identifier">m</span> = <span class="ruby-constant">Member</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">:user</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">User</span>.<span class="ruby-identifier">current</span>, <span class="ruby-identifier">:roles</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-identifier">r</span>])
83:           <span class="ruby-ivar">@project</span>.<span class="ruby-identifier">members</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">m</span>
84:         <span class="ruby-keyword kw">end</span>
85:         <span class="ruby-identifier">flash</span>[<span class="ruby-identifier">:notice</span>] = <span class="ruby-identifier">l</span>(<span class="ruby-identifier">:notice_successful_create</span>)
86:         <span class="ruby-identifier">redirect_to</span> <span class="ruby-identifier">:controller</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'projects'</span>, <span class="ruby-identifier">:action</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'settings'</span>, <span class="ruby-identifier">:id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@project</span>
87:       <span class="ruby-keyword kw">end</span>
88:     <span class="ruby-keyword kw">end</span> 
89:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000420" class="method-detail">
        <a name="M000420"></a>

        <div class="method-heading">
          <a href="#M000420" class="method-signature">
          <span class="method-name">add_file</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000420-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000420-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/projects_controller.rb, line 222</span>
222:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">add_file</span>
223:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">request</span>.<span class="ruby-identifier">post?</span>
224:       <span class="ruby-identifier">container</span> = (<span class="ruby-identifier">params</span>[<span class="ruby-identifier">:version_id</span>].<span class="ruby-identifier">blank?</span> <span class="ruby-value">? </span><span class="ruby-ivar">@project</span> <span class="ruby-operator">:</span> <span class="ruby-ivar">@project</span>.<span class="ruby-identifier">versions</span>.<span class="ruby-identifier">find_by_id</span>(<span class="ruby-identifier">params</span>[<span class="ruby-identifier">:version_id</span>]))
225:       <span class="ruby-identifier">attachments</span> = <span class="ruby-identifier">attach_files</span>(<span class="ruby-identifier">container</span>, <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:attachments</span>])
226:       <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">attachments</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-constant">Setting</span>.<span class="ruby-identifier">notified_events</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-value str">'file_added'</span>)
227:         <span class="ruby-constant">Mailer</span>.<span class="ruby-identifier">deliver_attachments_added</span>(<span class="ruby-identifier">attachments</span>)
228:       <span class="ruby-keyword kw">end</span>
229:       <span class="ruby-identifier">redirect_to</span> <span class="ruby-identifier">:controller</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'projects'</span>, <span class="ruby-identifier">:action</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'list_files'</span>, <span class="ruby-identifier">:id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@project</span>
230:       <span class="ruby-keyword kw">return</span>
231:     <span class="ruby-keyword kw">end</span>
232:     <span class="ruby-ivar">@versions</span> = <span class="ruby-ivar">@project</span>.<span class="ruby-identifier">versions</span>.<span class="ruby-identifier">sort</span>
233:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000418" class="method-detail">
        <a name="M000418"></a>

        <div class="method-heading">
          <a href="#M000418" class="method-signature">
          <span class="method-name">add_issue_category</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Add a new issue category to @project
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000418-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000418-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/projects_controller.rb, line 195</span>
195:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">add_issue_category</span>
196:     <span class="ruby-ivar">@category</span> = <span class="ruby-ivar">@project</span>.<span class="ruby-identifier">issue_categories</span>.<span class="ruby-identifier">build</span>(<span class="ruby-identifier">params</span>[<span class="ruby-identifier">:category</span>])
197:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">request</span>.<span class="ruby-identifier">post?</span> <span class="ruby-keyword kw">and</span> <span class="ruby-ivar">@category</span>.<span class="ruby-identifier">save</span>
198:           <span class="ruby-identifier">respond_to</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">format</span><span class="ruby-operator">|</span>
199:         <span class="ruby-identifier">format</span>.<span class="ruby-identifier">html</span> <span class="ruby-keyword kw">do</span>
200:           <span class="ruby-identifier">flash</span>[<span class="ruby-identifier">:notice</span>] = <span class="ruby-identifier">l</span>(<span class="ruby-identifier">:notice_successful_create</span>)
201:           <span class="ruby-identifier">redirect_to</span> <span class="ruby-identifier">:action</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'settings'</span>, <span class="ruby-identifier">:tab</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'categories'</span>, <span class="ruby-identifier">:id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@project</span>
202:         <span class="ruby-keyword kw">end</span>
203:         <span class="ruby-identifier">format</span>.<span class="ruby-identifier">js</span> <span class="ruby-keyword kw">do</span>
204:           <span class="ruby-comment cmt"># IE doesn't support the replace_html rjs method for select box options</span>
205:           <span class="ruby-identifier">render</span>(<span class="ruby-identifier">:update</span>) {<span class="ruby-operator">|</span><span class="ruby-identifier">page</span><span class="ruby-operator">|</span> <span class="ruby-identifier">page</span>.<span class="ruby-identifier">replace</span> <span class="ruby-value str">&quot;issue_category_id&quot;</span>,
206:             <span class="ruby-identifier">content_tag</span>(<span class="ruby-value str">'select'</span>, <span class="ruby-value str">'&lt;option&gt;&lt;/option&gt;'</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">options_from_collection_for_select</span>(<span class="ruby-ivar">@project</span>.<span class="ruby-identifier">issue_categories</span>, <span class="ruby-value str">'id'</span>, <span class="ruby-value str">'name'</span>, <span class="ruby-ivar">@category</span>.<span class="ruby-identifier">id</span>), <span class="ruby-identifier">:id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'issue_category_id'</span>, <span class="ruby-identifier">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'issue[category_id]'</span>)
207:           }
208:         <span class="ruby-keyword kw">end</span>
209:       <span class="ruby-keyword kw">end</span>
210:     <span class="ruby-keyword kw">end</span>
211:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000419" class="method-detail">
        <a name="M000419"></a>

        <div class="method-heading">
          <a href="#M000419" class="method-signature">
          <span class="method-name">add_version</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Add a new version to @project
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000419-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000419-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/projects_controller.rb, line 214</span>
214:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">add_version</span>
215:         <span class="ruby-ivar">@version</span> = <span class="ruby-ivar">@project</span>.<span class="ruby-identifier">versions</span>.<span class="ruby-identifier">build</span>(<span class="ruby-identifier">params</span>[<span class="ruby-identifier">:version</span>])
216:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">request</span>.<span class="ruby-identifier">post?</span> <span class="ruby-keyword kw">and</span> <span class="ruby-ivar">@version</span>.<span class="ruby-identifier">save</span>
217:           <span class="ruby-identifier">flash</span>[<span class="ruby-identifier">:notice</span>] = <span class="ruby-identifier">l</span>(<span class="ruby-identifier">:notice_successful_create</span>)
218:       <span class="ruby-identifier">redirect_to</span> <span class="ruby-identifier">:action</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'settings'</span>, <span class="ruby-identifier">:tab</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'versions'</span>, <span class="ruby-identifier">:id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@project</span>
219:         <span class="ruby-keyword kw">end</span>
220:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000415" class="method-detail">
        <a name="M000415"></a>

        <div class="method-heading">
          <a href="#M000415" class="method-signature">
          <span class="method-name">archive</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000415-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000415-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/projects_controller.rb, line 173</span>
173:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">archive</span>
174:     <span class="ruby-ivar">@project</span>.<span class="ruby-identifier">archive</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">request</span>.<span class="ruby-identifier">post?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@project</span>.<span class="ruby-identifier">active?</span>
175:     <span class="ruby-identifier">redirect_to</span> <span class="ruby-identifier">:controller</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'admin'</span>, <span class="ruby-identifier">:action</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'projects'</span>
176:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000422" class="method-detail">
        <a name="M000422"></a>

        <div class="method-heading">
          <a href="#M000422" class="method-signature">
          <span class="method-name">changelog</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Show <a href="ProjectsController.html#M000422">changelog</a> for @project
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000422-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000422-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/projects_controller.rb, line 248</span>
248:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">changelog</span>
249:     <span class="ruby-ivar">@trackers</span> = <span class="ruby-ivar">@project</span>.<span class="ruby-identifier">trackers</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>, <span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;is_in_chlog=?&quot;</span>, <span class="ruby-keyword kw">true</span>], <span class="ruby-identifier">:order</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'position'</span>)
250:     <span class="ruby-identifier">retrieve_selected_tracker_ids</span>(<span class="ruby-ivar">@trackers</span>)    
251:     <span class="ruby-ivar">@versions</span> = <span class="ruby-ivar">@project</span>.<span class="ruby-identifier">versions</span>.<span class="ruby-identifier">sort</span>
252:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000410" class="method-detail">
        <a name="M000410"></a>

        <div class="method-heading">
          <a href="#M000410" class="method-signature">
          <span class="method-name">copy</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000410-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000410-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/projects_controller.rb, line 91</span>
 91:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">copy</span>
 92:     <span class="ruby-ivar">@issue_custom_fields</span> = <span class="ruby-constant">IssueCustomField</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>, <span class="ruby-identifier">:order</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-node">&quot;#{CustomField.table_name}.position&quot;</span>)
 93:     <span class="ruby-ivar">@trackers</span> = <span class="ruby-constant">Tracker</span>.<span class="ruby-identifier">all</span>
 94:     <span class="ruby-ivar">@root_projects</span> = <span class="ruby-constant">Project</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>,
 95:                                   <span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-node">&quot;parent_id IS NULL AND status = #{Project::STATUS_ACTIVE}&quot;</span>,
 96:                                   <span class="ruby-identifier">:order</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'name'</span>)
 97:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">request</span>.<span class="ruby-identifier">get?</span>
 98:       <span class="ruby-ivar">@project</span> = <span class="ruby-constant">Project</span>.<span class="ruby-identifier">copy_from</span>(<span class="ruby-identifier">params</span>[<span class="ruby-identifier">:id</span>])
 99:       <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@project</span>
100:         <span class="ruby-ivar">@project</span>.<span class="ruby-identifier">identifier</span> = <span class="ruby-constant">Project</span>.<span class="ruby-identifier">next_identifier</span> <span class="ruby-keyword kw">if</span> <span class="ruby-constant">Setting</span>.<span class="ruby-identifier">sequential_project_identifiers?</span>
101:       <span class="ruby-keyword kw">else</span>
102:         <span class="ruby-identifier">redirect_to</span> <span class="ruby-identifier">:controller</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'admin'</span>, <span class="ruby-identifier">:action</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'projects'</span>
103:       <span class="ruby-keyword kw">end</span>  
104:     <span class="ruby-keyword kw">else</span>
105:       <span class="ruby-ivar">@project</span> = <span class="ruby-constant">Project</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">params</span>[<span class="ruby-identifier">:project</span>])
106:       <span class="ruby-ivar">@project</span>.<span class="ruby-identifier">enabled_module_names</span> = <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:enabled_modules</span>]
107:       <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@project</span>.<span class="ruby-identifier">copy</span>(<span class="ruby-identifier">params</span>[<span class="ruby-identifier">:id</span>])
108:         <span class="ruby-identifier">flash</span>[<span class="ruby-identifier">:notice</span>] = <span class="ruby-identifier">l</span>(<span class="ruby-identifier">:notice_successful_create</span>)
109:         <span class="ruby-identifier">redirect_to</span> <span class="ruby-identifier">:controller</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'admin'</span>, <span class="ruby-identifier">:action</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'projects'</span>
110:       <span class="ruby-keyword kw">end</span>               
111:     <span class="ruby-keyword kw">end</span> 
112:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000417" class="method-detail">
        <a name="M000417"></a>

        <div class="method-heading">
          <a href="#M000417" class="method-signature">
          <span class="method-name">destroy</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Delete @project
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000417-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000417-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/projects_controller.rb, line 184</span>
184:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">destroy</span>
185:     <span class="ruby-ivar">@project_to_destroy</span> = <span class="ruby-ivar">@project</span>
186:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">request</span>.<span class="ruby-identifier">post?</span> <span class="ruby-keyword kw">and</span> <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:confirm</span>]
187:       <span class="ruby-ivar">@project_to_destroy</span>.<span class="ruby-identifier">destroy</span>
188:       <span class="ruby-identifier">redirect_to</span> <span class="ruby-identifier">:controller</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'admin'</span>, <span class="ruby-identifier">:action</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'projects'</span>
189:     <span class="ruby-keyword kw">end</span>
190:     <span class="ruby-comment cmt"># hide project in layout</span>
191:     <span class="ruby-ivar">@project</span> = <span class="ruby-keyword kw">nil</span>
192:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000413" class="method-detail">
        <a name="M000413"></a>

        <div class="method-heading">
          <a href="#M000413" class="method-signature">
          <span class="method-name">edit</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Edit @project
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000413-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000413-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/projects_controller.rb, line 154</span>
154:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">edit</span>
155:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">request</span>.<span class="ruby-identifier">post?</span>
156:       <span class="ruby-ivar">@project</span>.<span class="ruby-identifier">attributes</span> = <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:project</span>]
157:       <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@project</span>.<span class="ruby-identifier">save</span>
158:         <span class="ruby-ivar">@project</span>.<span class="ruby-identifier">set_parent!</span>(<span class="ruby-identifier">params</span>[<span class="ruby-identifier">:project</span>][<span class="ruby-value str">'parent_id'</span>]) <span class="ruby-keyword kw">if</span> <span class="ruby-constant">User</span>.<span class="ruby-identifier">current</span>.<span class="ruby-identifier">admin?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:project</span>].<span class="ruby-identifier">has_key?</span>(<span class="ruby-value str">'parent_id'</span>)
159:         <span class="ruby-identifier">flash</span>[<span class="ruby-identifier">:notice</span>] = <span class="ruby-identifier">l</span>(<span class="ruby-identifier">:notice_successful_update</span>)
160:         <span class="ruby-identifier">redirect_to</span> <span class="ruby-identifier">:action</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'settings'</span>, <span class="ruby-identifier">:id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@project</span>
161:       <span class="ruby-keyword kw">else</span>
162:         <span class="ruby-identifier">settings</span>
163:         <span class="ruby-identifier">render</span> <span class="ruby-identifier">:action</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'settings'</span>
164:       <span class="ruby-keyword kw">end</span>
165:     <span class="ruby-keyword kw">end</span>
166:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000408" class="method-detail">
        <a name="M000408"></a>

        <div class="method-heading">
          <a href="#M000408" class="method-signature">
          <span class="method-name">index</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Lists visible projects
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000408-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000408-source">
<pre>
    <span class="ruby-comment cmt"># File app/controllers/projects_controller.rb, line 52</span>
52:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">index</span>
53:     <span class="ruby-identifier">respond_to</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">format</span><span class="ruby-operator">|</span>
54:       <span class="ruby-identifier">format</span>.<span class="ruby-identifier">html</span> { 
55:         <span class="ruby-ivar">@projects</span> = <span class="ruby-constant">Project</span>.<span class="ruby-identifier">visible</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>, <span class="ruby-identifier">:order</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'lft'</span>) 
56:       }
57:       <span class="ruby-identifier">format</span>.<span class="ruby-identifier">atom</span> {
58:         <span class="ruby-identifier">projects</span> = <span class="ruby-constant">Project</span>.<span class="ruby-identifier">visible</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>, <span class="ruby-identifier">:order</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'created_on DESC'</span>,
59:                                               <span class="ruby-identifier">:limit</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">Setting</span>.<span class="ruby-identifier">feeds_limit</span>.<span class="ruby-identifier">to_i</span>)
60:         <span class="ruby-identifier">render_feed</span>(<span class="ruby-identifier">projects</span>, <span class="ruby-identifier">:title</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-node">&quot;#{Setting.app_title}: #{l(:label_project_latest)}&quot;</span>)
61:       }
62:     <span class="ruby-keyword kw">end</span>
63:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000421" class="method-detail">
        <a name="M000421"></a>

        <div class="method-heading">
          <a href="#M000421" class="method-signature">
          <span class="method-name">list_files</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000421-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000421-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/projects_controller.rb, line 235</span>
235:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">list_files</span>
236:     <span class="ruby-identifier">sort_init</span> <span class="ruby-value str">'filename'</span>, <span class="ruby-value str">'asc'</span>
237:     <span class="ruby-identifier">sort_update</span> <span class="ruby-value str">'filename'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-node">&quot;#{Attachment.table_name}.filename&quot;</span>,
238:                 <span class="ruby-value str">'created_on'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-node">&quot;#{Attachment.table_name}.created_on&quot;</span>,
239:                 <span class="ruby-value str">'size'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-node">&quot;#{Attachment.table_name}.filesize&quot;</span>,
240:                 <span class="ruby-value str">'downloads'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-node">&quot;#{Attachment.table_name}.downloads&quot;</span>
241:                 
242:     <span class="ruby-ivar">@containers</span> = [ <span class="ruby-constant">Project</span>.<span class="ruby-identifier">find</span>(<span class="ruby-ivar">@project</span>.<span class="ruby-identifier">id</span>, <span class="ruby-identifier">:include</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:attachments</span>, <span class="ruby-identifier">:order</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">sort_clause</span>)]
243:     <span class="ruby-ivar">@containers</span> <span class="ruby-operator">+=</span> <span class="ruby-ivar">@project</span>.<span class="ruby-identifier">versions</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>, <span class="ruby-identifier">:include</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:attachments</span>, <span class="ruby-identifier">:order</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">sort_clause</span>).<span class="ruby-identifier">sort</span>.<span class="ruby-identifier">reverse</span>
244:     <span class="ruby-identifier">render</span> <span class="ruby-identifier">:layout</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">request</span>.<span class="ruby-identifier">xhr?</span>
245:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000414" class="method-detail">
        <a name="M000414"></a>

        <div class="method-heading">
          <a href="#M000414" class="method-signature">
          <span class="method-name">modules</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000414-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000414-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/projects_controller.rb, line 168</span>
168:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">modules</span>
169:     <span class="ruby-ivar">@project</span>.<span class="ruby-identifier">enabled_module_names</span> = <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:enabled_modules</span>]
170:     <span class="ruby-identifier">redirect_to</span> <span class="ruby-identifier">:action</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'settings'</span>, <span class="ruby-identifier">:id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@project</span>, <span class="ruby-identifier">:tab</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'modules'</span>
171:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000423" class="method-detail">
        <a name="M000423"></a>

        <div class="method-heading">
          <a href="#M000423" class="method-signature">
          <span class="method-name">roadmap</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000423-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000423-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/projects_controller.rb, line 254</span>
254:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">roadmap</span>
255:     <span class="ruby-ivar">@trackers</span> = <span class="ruby-ivar">@project</span>.<span class="ruby-identifier">trackers</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>, <span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-value str">&quot;is_in_roadmap=?&quot;</span>, <span class="ruby-keyword kw">true</span>])
256:     <span class="ruby-identifier">retrieve_selected_tracker_ids</span>(<span class="ruby-ivar">@trackers</span>)
257:     <span class="ruby-ivar">@versions</span> = <span class="ruby-ivar">@project</span>.<span class="ruby-identifier">versions</span>.<span class="ruby-identifier">sort</span>
258:     <span class="ruby-ivar">@versions</span> = <span class="ruby-ivar">@versions</span>.<span class="ruby-identifier">select</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">v</span><span class="ruby-operator">|</span> <span class="ruby-operator">!</span><span class="ruby-identifier">v</span>.<span class="ruby-identifier">completed?</span> } <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:completed</span>]
259:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000412" class="method-detail">
        <a name="M000412"></a>

        <div class="method-heading">
          <a href="#M000412" class="method-signature">
          <span class="method-name">settings</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000412-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000412-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/projects_controller.rb, line 144</span>
144:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">settings</span>
145:     <span class="ruby-ivar">@issue_custom_fields</span> = <span class="ruby-constant">IssueCustomField</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>, <span class="ruby-identifier">:order</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-node">&quot;#{CustomField.table_name}.position&quot;</span>)
146:     <span class="ruby-ivar">@issue_category</span> <span class="ruby-operator">||=</span> <span class="ruby-constant">IssueCategory</span>.<span class="ruby-identifier">new</span>
147:     <span class="ruby-ivar">@member</span> <span class="ruby-operator">||=</span> <span class="ruby-ivar">@project</span>.<span class="ruby-identifier">members</span>.<span class="ruby-identifier">new</span>
148:     <span class="ruby-ivar">@trackers</span> = <span class="ruby-constant">Tracker</span>.<span class="ruby-identifier">all</span>
149:     <span class="ruby-ivar">@repository</span> <span class="ruby-operator">||=</span> <span class="ruby-ivar">@project</span>.<span class="ruby-identifier">repository</span>
150:     <span class="ruby-ivar">@wiki</span> <span class="ruby-operator">||=</span> <span class="ruby-ivar">@project</span>.<span class="ruby-identifier">wiki</span>
151:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000411" class="method-detail">
        <a name="M000411"></a>

        <div class="method-heading">
          <a href="#M000411" class="method-signature">
          <span class="method-name">show</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Show @project
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000411-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000411-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/projects_controller.rb, line 116</span>
116:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">show</span>
117:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:jump</span>]
118:       <span class="ruby-comment cmt"># try to redirect to the requested menu item</span>
119:       <span class="ruby-identifier">redirect_to_project_menu_item</span>(<span class="ruby-ivar">@project</span>, <span class="ruby-identifier">params</span>[<span class="ruby-identifier">:jump</span>]) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-keyword kw">return</span>
120:     <span class="ruby-keyword kw">end</span>
121:     
122:     <span class="ruby-ivar">@users_by_role</span> = <span class="ruby-ivar">@project</span>.<span class="ruby-identifier">users_by_role</span>
123:     <span class="ruby-ivar">@subprojects</span> = <span class="ruby-ivar">@project</span>.<span class="ruby-identifier">children</span>.<span class="ruby-identifier">visible</span>
124:     <span class="ruby-ivar">@news</span> = <span class="ruby-ivar">@project</span>.<span class="ruby-identifier">news</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>, <span class="ruby-identifier">:limit</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">5</span>, <span class="ruby-identifier">:include</span> =<span class="ruby-operator">&gt;</span> [ <span class="ruby-identifier">:author</span>, <span class="ruby-identifier">:project</span> ], <span class="ruby-identifier">:order</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-node">&quot;#{News.table_name}.created_on DESC&quot;</span>)
125:     <span class="ruby-ivar">@trackers</span> = <span class="ruby-ivar">@project</span>.<span class="ruby-identifier">rolled_up_trackers</span>
126:     
127:     <span class="ruby-identifier">cond</span> = <span class="ruby-ivar">@project</span>.<span class="ruby-identifier">project_condition</span>(<span class="ruby-constant">Setting</span>.<span class="ruby-identifier">display_subprojects_issues?</span>)
128:     
129:     <span class="ruby-ivar">@open_issues_by_tracker</span> = <span class="ruby-constant">Issue</span>.<span class="ruby-identifier">visible</span>.<span class="ruby-identifier">count</span>(<span class="ruby-identifier">:group</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:tracker</span>,
130:                                             <span class="ruby-identifier">:include</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-identifier">:project</span>, <span class="ruby-identifier">:status</span>, <span class="ruby-identifier">:tracker</span>],
131:                                             <span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-node">&quot;(#{cond}) AND #{IssueStatus.table_name}.is_closed=?&quot;</span>, <span class="ruby-keyword kw">false</span>])
132:     <span class="ruby-ivar">@total_issues_by_tracker</span> = <span class="ruby-constant">Issue</span>.<span class="ruby-identifier">visible</span>.<span class="ruby-identifier">count</span>(<span class="ruby-identifier">:group</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:tracker</span>,
133:                                             <span class="ruby-identifier">:include</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-identifier">:project</span>, <span class="ruby-identifier">:status</span>, <span class="ruby-identifier">:tracker</span>],
134:                                             <span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">cond</span>)
135:     
136:     <span class="ruby-constant">TimeEntry</span>.<span class="ruby-identifier">visible_by</span>(<span class="ruby-constant">User</span>.<span class="ruby-identifier">current</span>) <span class="ruby-keyword kw">do</span>
137:       <span class="ruby-ivar">@total_hours</span> = <span class="ruby-constant">TimeEntry</span>.<span class="ruby-identifier">sum</span>(<span class="ruby-identifier">:hours</span>, 
138:                                    <span class="ruby-identifier">:include</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">:project</span>,
139:                                    <span class="ruby-identifier">:conditions</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">cond</span>).<span class="ruby-identifier">to_f</span>
140:     <span class="ruby-keyword kw">end</span>
141:     <span class="ruby-ivar">@key</span> = <span class="ruby-constant">User</span>.<span class="ruby-identifier">current</span>.<span class="ruby-identifier">rss_key</span>
142:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000416" class="method-detail">
        <a name="M000416"></a>

        <div class="method-heading">
          <a href="#M000416" class="method-signature">
          <span class="method-name">unarchive</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000416-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000416-source">
<pre>
     <span class="ruby-comment cmt"># File app/controllers/projects_controller.rb, line 178</span>
178:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">unarchive</span>
179:     <span class="ruby-ivar">@project</span>.<span class="ruby-identifier">unarchive</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">request</span>.<span class="ruby-identifier">post?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@project</span>.<span class="ruby-identifier">active?</span>
180:     <span class="ruby-identifier">redirect_to</span> <span class="ruby-identifier">:controller</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'admin'</span>, <span class="ruby-identifier">:action</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'projects'</span>
181:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>


    </div>


  </div>


<div id="validator-badges">
  <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
</div>

</body>
</html>