<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>Class: SVG::Graph::TimeSeries</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Script-Type" content="text/javascript" />
  <link rel="stylesheet" href="../../.././rdoc-style.css" type="text/css" media="screen" />
  <script type="text/javascript">
  // <![CDATA[

  function popupCode( url ) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }

  function toggleCode( id ) {
    if ( document.getElementById )
      elem = document.getElementById( id );
    else if ( document.all )
      elem = eval( "document.all." + id );
    else
      return false;

    elemStyle = elem.style;
    
    if ( elemStyle.display != "block" ) {
      elemStyle.display = "block"
    } else {
      elemStyle.display = "none"
    }

    return true;
  }
  
  // Make codeblocks hidden by default
  document.writeln( "<style type=\"text/css\">div.method-source-code { display: none }</style>" )
  
  // ]]>
  </script>

</head>
<body>



    <div id="classHeader">
        <table class="header-table">
        <tr class="top-aligned-row">
          <td><strong>Class</strong></td>
          <td class="class-name-in-header">SVG::Graph::TimeSeries</td>
        </tr>
        <tr class="top-aligned-row">
            <td><strong>In:</strong></td>
            <td>
                <a href="../../../files/lib/SVG/Graph/TimeSeries_rb.html">
                lib/SVG/Graph/TimeSeries.rb
                </a>
        <br />
            </td>
        </tr>

        <tr class="top-aligned-row">
            <td><strong>Parent:</strong></td>
            <td>
                <a href="Plot.html">
                Plot
               </a>
            </td>
        </tr>
        </table>
    </div>
  <!-- banner header -->

  <div id="bodyContent">



  <div id="contextContent">

    <div id="description">
      <h3>For creating <a href="../../SVG.html">SVG</a> plots of scalar temporal data</h3>
<h1>Synopsis</h1>
<pre>
  require 'SVG/Graph/TimeSeriess'

  # Data sets are x,y pairs
  data1 = [&quot;6/17/72&quot;, 11,    &quot;1/11/72&quot;, 7,    &quot;4/13/04 17:31&quot;, 11,
          &quot;9/11/01&quot;, 9,    &quot;9/1/85&quot;, 2,    &quot;9/1/88&quot;, 1,    &quot;1/15/95&quot;, 13]
  data2 = [&quot;8/1/73&quot;, 18,    &quot;3/1/77&quot;, 15,    &quot;10/1/98&quot;, 4,
          &quot;5/1/02&quot;, 14,    &quot;3/1/95&quot;, 6,    &quot;8/1/91&quot;, 12,    &quot;12/1/87&quot;, 6,
          &quot;5/1/84&quot;, 17,    &quot;10/1/80&quot;, 12]

  graph = SVG::Graph::TimeSeries.new( {
    :width =&gt; 640,
    :height =&gt; 480,
    :graph_title =&gt; title,
    :show_graph_title =&gt; true,
    :no_css =&gt; true,
    :key =&gt; true,
    :scale_x_integers =&gt; true,
    :scale_y_integers =&gt; true,
    :min_x_value =&gt; 0,
    :min_y_value =&gt; 0,
    :show_data_labels =&gt; true,
    :show_x_guidelines =&gt; true,
    :show_x_title =&gt; true,
    :x_title =&gt; &quot;Time&quot;,
    :show_y_title =&gt; true,
    :y_title =&gt; &quot;Ice Cream Cones&quot;,
    :y_title_text_direction =&gt; :bt,
    :stagger_x_labels =&gt; true,
    :x_label_format =&gt; &quot;%m/%d/%y&quot;,
  })

  graph.add_data({
          :data =&gt; projection
    :title =&gt; 'Projected',
  })

  graph.add_data({
          :data =&gt; actual,
    :title =&gt; 'Actual',
  })

  print graph.burn()
</pre>
<h1>Description</h1>
<p>
Produces a graph of temporal scalar data.
</p>
<h1>Examples</h1>
<p>
<a
href="http://www.germane-software/repositories/public/SVG/test/timeseries.rb">www.germane-software/repositories/public/SVG/test/timeseries.rb</a>
</p>
<h1>Notes</h1>
<p>
The default stylesheet handles upto 10 data sets, if you use more you must
create your own stylesheet and add the additional settings for the extra
data sets. You will know if you go over 10 data sets as they will have no
style and be in black.
</p>
<p>
Unlike the other types of charts, data sets must contain x,y pairs:
</p>
<pre>
  [ &quot;12:30&quot;, 2 ]          # A data set with 1 point: (&quot;12:30&quot;,2)
  [ &quot;01:00&quot;,2, &quot;14:20&quot;,6] # A data set with 2 points: (&quot;01:00&quot;,2) and
                          #                           (&quot;14:20&quot;,6)
</pre>
<p>
Note that multiple data sets within the same chart can differ in length,
and that the data in the datasets needn&#8216;t be in order; they will be
ordered by the plot along the X-axis.
</p>
<p>
The dates must be parseable by ParseDate, but otherwise can be any order of
magnitude (seconds within the hour, or years)
</p>
<h1>See also</h1>
<ul>
<li><a href="../Graph.html">SVG::Graph::Graph</a>

</li>
<li><a href="BarHorizontal.html">SVG::Graph::BarHorizontal</a>

</li>
<li><a href="Bar.html">SVG::Graph::Bar</a>

</li>
<li><a href="Line.html">SVG::Graph::Line</a>

</li>
<li><a href="Pie.html">SVG::Graph::Pie</a>

</li>
<li><a href="Plot.html">SVG::Graph::Plot</a>

</li>
</ul>
<h2>Author</h2>
<p>
Sean E. Russell &lt;serATgermaneHYPHENsoftwareDOTcom&gt;
</p>
<p>
Copyright 2004 Sean E. Russell This software is available under the Ruby <a
href="http://LICENSE.txt">license</a>
</p>

    </div>


   </div>

    <div id="method-list">
      <h3 class="section-bar">Methods</h3>

      <div class="name-list">
      <a href="#M000786">add_data</a>&nbsp;&nbsp;
      <a href="#M000788">format</a>&nbsp;&nbsp;
      <a href="#M000789">get_x_labels</a>&nbsp;&nbsp;
      <a href="#M000787">min_x_value=</a>&nbsp;&nbsp;
      <a href="#M000785">set_defaults</a>&nbsp;&nbsp;
      </div>
    </div>

  </div>


    <!-- if includes -->

    <div id="section">





    <div id="attribute-list">
      <h3 class="section-bar">Attributes</h3>

      <div class="name-list">
        <table>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">popup_format</td>
          <td class="context-item-value">&nbsp;[RW]&nbsp;</td>
          <td class="context-item-desc">
The formatting used for the popups. See x_label_format

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">timescale_divisions</td>
          <td class="context-item-value">&nbsp;[RW]&nbsp;</td>
          <td class="context-item-desc">
Use this to set the spacing between dates on the axis. The value must be of
the form &quot;\d+ ?(days|weeks|months|years|hours|minutes|seconds)?&quot;

<p>
EG:
</p>
<pre>
  graph.timescale_divisions = &quot;2 weeks&quot;
</pre>
<p>
will cause the chart to try to divide the X axis up into segments of two
week periods.
</p>
</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">x_label_format</td>
          <td class="context-item-value">&nbsp;[RW]&nbsp;</td>
          <td class="context-item-desc">
The <a href="TimeSeries.html#M000788">format</a> string use do <a
href="TimeSeries.html#M000788">format</a> the X axis labels. See
Time::strformat

</td>
        </tr>
        </table>
      </div>
    </div>
      


    <!-- if method_list -->
    <div id="methods">
      <h3 class="section-bar">Public Instance methods</h3>

      <div id="method-M000786" class="method-detail">
        <a name="M000786"></a>

        <div class="method-heading">
          <a href="#M000786" class="method-signature">
          <span class="method-name">add_data</span><span class="method-args">(data)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Add data to the plot.
</p>
<pre>
  d1 = [ &quot;12:30&quot;, 2 ]          # A data set with 1 point: (&quot;12:30&quot;,2)
  d2 = [ &quot;01:00&quot;,2, &quot;14:20&quot;,6] # A data set with 2 points: (&quot;01:00&quot;,2) and
                               #                           (&quot;14:20&quot;,6)
  graph.add_data(
    :data =&gt; d1,
    :title =&gt; 'One'
  )
  graph.add_data(
    :data =&gt; d2,
    :title =&gt; 'Two'
  )
</pre>
<p>
Note that the data must be in time,value pairs, and that the date <a
href="TimeSeries.html#M000788">format</a> may be any date that is parseable
by ParseDate.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000786-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000786-source">
<pre>
     <span class="ruby-comment cmt"># File lib/SVG/Graph/TimeSeries.rb, line 145</span>
145:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">add_data</span> <span class="ruby-identifier">data</span>
146:         <span class="ruby-ivar">@data</span> = [] <span class="ruby-keyword kw">unless</span> <span class="ruby-ivar">@data</span>
147:        
148:         <span class="ruby-identifier">raise</span> <span class="ruby-node">&quot;No data provided by #{@data.inspect}&quot;</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">data</span>[<span class="ruby-identifier">:data</span>] <span class="ruby-keyword kw">and</span>
149:                                                     <span class="ruby-identifier">data</span>[<span class="ruby-identifier">:data</span>].<span class="ruby-identifier">kind_of?</span> <span class="ruby-constant">Array</span>
150:         <span class="ruby-identifier">raise</span> <span class="ruby-value str">&quot;Data supplied must be x,y pairs!  &quot;</span><span class="ruby-operator">+</span>
151:           <span class="ruby-value str">&quot;The data provided contained an odd set of &quot;</span><span class="ruby-operator">+</span>
152:           <span class="ruby-value str">&quot;data points&quot;</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">data</span>[<span class="ruby-identifier">:data</span>].<span class="ruby-identifier">length</span> <span class="ruby-operator">%</span> <span class="ruby-value">2</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span>
153:         <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">data</span>[<span class="ruby-identifier">:data</span>].<span class="ruby-identifier">length</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span>
154: 
155: 
156:         <span class="ruby-identifier">x</span> = []
157:         <span class="ruby-identifier">y</span> = []
158:         <span class="ruby-identifier">data</span>[<span class="ruby-identifier">:data</span>].<span class="ruby-identifier">each_index</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">i</span><span class="ruby-operator">|</span>
159:           <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">i</span><span class="ruby-operator">%</span><span class="ruby-value">2</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span>
160:             <span class="ruby-identifier">arr</span> = <span class="ruby-constant">ParseDate</span>.<span class="ruby-identifier">parsedate</span>( <span class="ruby-identifier">data</span>[<span class="ruby-identifier">:data</span>][<span class="ruby-identifier">i</span>] )
161:             <span class="ruby-identifier">t</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">local</span>( <span class="ruby-operator">*</span><span class="ruby-identifier">arr</span>[<span class="ruby-value">0</span>,<span class="ruby-value">6</span>].<span class="ruby-identifier">compact</span> )
162:             <span class="ruby-identifier">x</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">to_i</span>
163:           <span class="ruby-keyword kw">else</span>
164:             <span class="ruby-identifier">y</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">data</span>[<span class="ruby-identifier">:data</span>][<span class="ruby-identifier">i</span>]
165:           <span class="ruby-keyword kw">end</span>
166:         }
167:         <span class="ruby-identifier">sort</span>( <span class="ruby-identifier">x</span>, <span class="ruby-identifier">y</span> )
168:         <span class="ruby-identifier">data</span>[<span class="ruby-identifier">:data</span>] = [<span class="ruby-identifier">x</span>,<span class="ruby-identifier">y</span>]
169:         <span class="ruby-ivar">@data</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">data</span>
170:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000785" class="method-detail">
        <a name="M000785"></a>

        <div class="method-heading">
          <a href="#M000785" class="method-signature">
          <span class="method-name">set_defaults</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
In addition to the defaults set by Graph::initialize and
Plot::set_defaults, sets:
</p>
<dl>
<dt>x_label_format</dt><dd>&#8217;%Y-%m-%d %H:%M:%S&#8216;

</dd>
<dt>popup_format</dt><dd>&#8217;%Y-%m-%d %H:%M:%S&#8216;

</dd>
</dl>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000785-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000785-source">
<pre>
     <span class="ruby-comment cmt"># File lib/SVG/Graph/TimeSeries.rb, line 103</span>
103:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">set_defaults</span>
104:         <span class="ruby-keyword kw">super</span>
105:         <span class="ruby-identifier">init_with</span>(
106:           <span class="ruby-comment cmt">#:max_time_span     =&gt; '',</span>
107:           <span class="ruby-identifier">:x_label_format</span>     =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'%Y-%m-%d %H:%M:%S'</span>,
108:           <span class="ruby-identifier">:popup_format</span>       =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'%Y-%m-%d %H:%M:%S'</span>
109:         )
110:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <h3 class="section-bar">Protected Instance methods</h3>

      <div id="method-M000788" class="method-detail">
        <a name="M000788"></a>

        <div class="method-heading">
          <a href="#M000788" class="method-signature">
          <span class="method-name">format</span><span class="method-args">(x, y)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000788-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000788-source">
<pre>
     <span class="ruby-comment cmt"># File lib/SVG/Graph/TimeSeries.rb, line 181</span>
181:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">format</span> <span class="ruby-identifier">x</span>, <span class="ruby-identifier">y</span>
182:         <span class="ruby-constant">Time</span>.<span class="ruby-identifier">at</span>( <span class="ruby-identifier">x</span> ).<span class="ruby-identifier">strftime</span>( <span class="ruby-identifier">popup_format</span> )
183:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000789" class="method-detail">
        <a name="M000789"></a>

        <div class="method-heading">
          <a href="#M000789" class="method-signature">
          <span class="method-name">get_x_labels</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000789-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000789-source">
<pre>
     <span class="ruby-comment cmt"># File lib/SVG/Graph/TimeSeries.rb, line 185</span>
185:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">get_x_labels</span>
186:         <span class="ruby-identifier">get_x_values</span>.<span class="ruby-identifier">collect</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">v</span><span class="ruby-operator">|</span> <span class="ruby-constant">Time</span>.<span class="ruby-identifier">at</span>(<span class="ruby-identifier">v</span>).<span class="ruby-identifier">strftime</span>( <span class="ruby-identifier">x_label_format</span> ) }
187:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000787" class="method-detail">
        <a name="M000787"></a>

        <div class="method-heading">
          <a href="#M000787" class="method-signature">
          <span class="method-name">min_x_value=</span><span class="method-args">(value)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000787-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000787-source">
<pre>
     <span class="ruby-comment cmt"># File lib/SVG/Graph/TimeSeries.rb, line 175</span>
175:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">min_x_value=</span>(<span class="ruby-identifier">value</span>)
176:         <span class="ruby-identifier">arr</span> = <span class="ruby-constant">ParseDate</span>.<span class="ruby-identifier">parsedate</span>( <span class="ruby-identifier">value</span> )
177:         <span class="ruby-ivar">@min_x_value</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">local</span>( <span class="ruby-operator">*</span><span class="ruby-identifier">arr</span>[<span class="ruby-value">0</span>,<span class="ruby-value">6</span>].<span class="ruby-identifier">compact</span> ).<span class="ruby-identifier">to_i</span>
178:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>


    </div>


  </div>


<div id="validator-badges">
  <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
</div>

</body>
</html>