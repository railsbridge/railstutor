<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>Class: Redmine::Scm::Adapters::CvsAdapter</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Script-Type" content="text/javascript" />
  <link rel="stylesheet" href="../../../.././rdoc-style.css" type="text/css" media="screen" />
  <script type="text/javascript">
  // <![CDATA[

  function popupCode( url ) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }

  function toggleCode( id ) {
    if ( document.getElementById )
      elem = document.getElementById( id );
    else if ( document.all )
      elem = eval( "document.all." + id );
    else
      return false;

    elemStyle = elem.style;
    
    if ( elemStyle.display != "block" ) {
      elemStyle.display = "block"
    } else {
      elemStyle.display = "none"
    }

    return true;
  }
  
  // Make codeblocks hidden by default
  document.writeln( "<style type=\"text/css\">div.method-source-code { display: none }</style>" )
  
  // ]]>
  </script>

</head>
<body>



    <div id="classHeader">
        <table class="header-table">
        <tr class="top-aligned-row">
          <td><strong>Class</strong></td>
          <td class="class-name-in-header">Redmine::Scm::Adapters::CvsAdapter</td>
        </tr>
        <tr class="top-aligned-row">
            <td><strong>In:</strong></td>
            <td>
                <a href="../../../../files/lib/redmine/scm/adapters/cvs_adapter_rb.html">
                lib/redmine/scm/adapters/cvs_adapter.rb
                </a>
        <br />
            </td>
        </tr>

        <tr class="top-aligned-row">
            <td><strong>Parent:</strong></td>
            <td>
                AbstractAdapter
            </td>
        </tr>
        </table>
    </div>
  <!-- banner header -->

  <div id="bodyContent">



  <div id="contextContent">



   </div>

    <div id="method-list">
      <h3 class="section-bar">Methods</h3>

      <div class="name-list">
      <a href="#M000936">annotate</a>&nbsp;&nbsp;
      <a href="#M000935">cat</a>&nbsp;&nbsp;
      <a href="#M000934">diff</a>&nbsp;&nbsp;
      <a href="#M000932">entries</a>&nbsp;&nbsp;
      <a href="#M000931">get_previous_revision</a>&nbsp;&nbsp;
      <a href="#M000930">info</a>&nbsp;&nbsp;
      <a href="#M000927">new</a>&nbsp;&nbsp;
      <a href="#M000933">revisions</a>&nbsp;&nbsp;
      <a href="#M000928">root_url</a>&nbsp;&nbsp;
      <a href="#M000929">url</a>&nbsp;&nbsp;
      </div>
    </div>

  </div>


    <!-- if includes -->

    <div id="section">


    <div id="constants-list">
      <h3 class="section-bar">Constants</h3>

      <div class="name-list">
        <table summary="Constants">
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">CVS_BIN</td>
          <td>=</td>
          <td class="context-item-value">&quot;cvs&quot;</td>
          <td width="3em">&nbsp;</td>
          <td class="context-item-desc">
CVS executable name

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">STARTLOG</td>
          <td>=</td>
          <td class="context-item-value">&quot;----------------------------&quot;</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">ENDLOG</td>
          <td>=</td>
          <td class="context-item-value">&quot;=============================================================================&quot;</td>
        </tr>
        </table>
      </div>
    </div>



      


    <!-- if method_list -->
    <div id="methods">
      <h3 class="section-bar">Public Class methods</h3>

      <div id="method-M000927" class="method-detail">
        <a name="M000927"></a>

        <div class="method-heading">
          <a href="#M000927" class="method-signature">
          <span class="method-name">new</span><span class="method-args">(url, root_url=nil, login=nil, password=nil)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Guidelines for the input:
</p>
<pre>
 url -&gt; the project-path, relative to the cvsroot (eg. module name)
 root_url -&gt; the good old, sometimes damned, CVSROOT
 login -&gt; unnecessary
 password -&gt; unnecessary too
</pre>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000927-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000927-source">
<pre>
    <span class="ruby-comment cmt"># File lib/redmine/scm/adapters/cvs_adapter.rb, line 33</span>
33:         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-identifier">url</span>, <span class="ruby-identifier">root_url</span>=<span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">login</span>=<span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">password</span>=<span class="ruby-keyword kw">nil</span>)
34:           <span class="ruby-ivar">@url</span> = <span class="ruby-identifier">url</span>
35:           <span class="ruby-ivar">@login</span> = <span class="ruby-identifier">login</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">login</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">login</span>.<span class="ruby-identifier">empty?</span>
36:           <span class="ruby-ivar">@password</span> = (<span class="ruby-identifier">password</span> <span class="ruby-operator">||</span> <span class="ruby-value str">&quot;&quot;</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@login</span>
37:           <span class="ruby-comment cmt">#TODO: better Exception here (IllegalArgumentException)</span>
38:           <span class="ruby-identifier">raise</span> <span class="ruby-constant">CommandFailed</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">root_url</span>.<span class="ruby-identifier">blank?</span>
39:           <span class="ruby-ivar">@root_url</span> = <span class="ruby-identifier">root_url</span>
40:         <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <h3 class="section-bar">Public Instance methods</h3>

      <div id="method-M000936" class="method-detail">
        <a name="M000936"></a>

        <div class="method-heading">
          <a href="#M000936" class="method-signature">
          <span class="method-name">annotate</span><span class="method-args">(path, identifier=nil)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000936-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000936-source">
<pre>
     <span class="ruby-comment cmt"># File lib/redmine/scm/adapters/cvs_adapter.rb, line 258</span>
258:         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">annotate</span>(<span class="ruby-identifier">path</span>, <span class="ruby-identifier">identifier</span>=<span class="ruby-keyword kw">nil</span>)
259:           <span class="ruby-identifier">identifier</span> = (<span class="ruby-identifier">identifier</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">identifier</span> <span class="ruby-operator">:</span> <span class="ruby-value str">&quot;HEAD&quot;</span>
260:           <span class="ruby-identifier">logger</span>.<span class="ruby-identifier">debug</span> <span class="ruby-node">&quot;&lt;cvs&gt; annotate path:'#{path}',identifier #{identifier}&quot;</span>
261:           <span class="ruby-identifier">path_with_project</span>=<span class="ruby-node">&quot;#{url}#{with_leading_slash(path)}&quot;</span>
262:           <span class="ruby-identifier">cmd</span> = <span class="ruby-node">&quot;#{CVS_BIN} -d #{root_url} rannotate -r#{identifier} #{shell_quote path_with_project}&quot;</span>
263:           <span class="ruby-identifier">blame</span> = <span class="ruby-constant">Annotate</span>.<span class="ruby-identifier">new</span>
264:           <span class="ruby-identifier">shellout</span>(<span class="ruby-identifier">cmd</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">io</span><span class="ruby-operator">|</span>
265:             <span class="ruby-identifier">io</span>.<span class="ruby-identifier">each_line</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">line</span><span class="ruby-operator">|</span>
266:               <span class="ruby-keyword kw">next</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">line</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">%r{^([\d\.]+)\s+\(([^\)]+)\s+[^\)]+\):\s(.*)$}</span>
267:               <span class="ruby-identifier">blame</span>.<span class="ruby-identifier">add_line</span>(<span class="ruby-identifier">$3</span>.<span class="ruby-identifier">rstrip</span>, <span class="ruby-constant">Revision</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">:revision</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">$1</span>, <span class="ruby-identifier">:author</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">$2</span>.<span class="ruby-identifier">strip</span>))
268:             <span class="ruby-keyword kw">end</span>
269:           <span class="ruby-keyword kw">end</span>
270:           <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">$?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">$?</span>.<span class="ruby-identifier">exitstatus</span> <span class="ruby-operator">!=</span> <span class="ruby-value">0</span>
271:           <span class="ruby-identifier">blame</span>
272:         <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000935" class="method-detail">
        <a name="M000935"></a>

        <div class="method-heading">
          <a href="#M000935" class="method-signature">
          <span class="method-name">cat</span><span class="method-args">(path, identifier=nil)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000935-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000935-source">
<pre>
     <span class="ruby-comment cmt"># File lib/redmine/scm/adapters/cvs_adapter.rb, line 243</span>
243:         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">cat</span>(<span class="ruby-identifier">path</span>, <span class="ruby-identifier">identifier</span>=<span class="ruby-keyword kw">nil</span>)
244:           <span class="ruby-identifier">identifier</span> = (<span class="ruby-identifier">identifier</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">identifier</span> <span class="ruby-operator">:</span> <span class="ruby-value str">&quot;HEAD&quot;</span>
245:           <span class="ruby-identifier">logger</span>.<span class="ruby-identifier">debug</span> <span class="ruby-node">&quot;&lt;cvs&gt; cat path:'#{path}',identifier #{identifier}&quot;</span>
246:           <span class="ruby-identifier">path_with_project</span>=<span class="ruby-node">&quot;#{url}#{with_leading_slash(path)}&quot;</span>
247:           <span class="ruby-identifier">cmd</span> = <span class="ruby-node">&quot;#{CVS_BIN} -d #{root_url} co&quot;</span>
248:           <span class="ruby-identifier">cmd</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot; -D \&quot;#{time_to_cvstime(identifier)}\&quot;&quot;</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">identifier</span>
249:           <span class="ruby-identifier">cmd</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot; -p #{shell_quote path_with_project}&quot;</span>
250:           <span class="ruby-identifier">cat</span> = <span class="ruby-keyword kw">nil</span>
251:           <span class="ruby-identifier">shellout</span>(<span class="ruby-identifier">cmd</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">io</span><span class="ruby-operator">|</span>
252:             <span class="ruby-identifier">cat</span> = <span class="ruby-identifier">io</span>.<span class="ruby-identifier">read</span>
253:           <span class="ruby-keyword kw">end</span>
254:           <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">$?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">$?</span>.<span class="ruby-identifier">exitstatus</span> <span class="ruby-operator">!=</span> <span class="ruby-value">0</span>
255:           <span class="ruby-identifier">cat</span>
256:         <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000934" class="method-detail">
        <a name="M000934"></a>

        <div class="method-heading">
          <a href="#M000934" class="method-signature">
          <span class="method-name">diff</span><span class="method-args">(path, identifier_from, identifier_to=nil)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000934-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000934-source">
<pre>
     <span class="ruby-comment cmt"># File lib/redmine/scm/adapters/cvs_adapter.rb, line 229</span>
229:         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">diff</span>(<span class="ruby-identifier">path</span>, <span class="ruby-identifier">identifier_from</span>, <span class="ruby-identifier">identifier_to</span>=<span class="ruby-keyword kw">nil</span>)
230:           <span class="ruby-identifier">logger</span>.<span class="ruby-identifier">debug</span> <span class="ruby-node">&quot;&lt;cvs&gt; diff path:'#{path}',identifier_from #{identifier_from}, identifier_to #{identifier_to}&quot;</span>
231:           <span class="ruby-identifier">path_with_project</span>=<span class="ruby-node">&quot;#{url}#{with_leading_slash(path)}&quot;</span>
232:           <span class="ruby-identifier">cmd</span> = <span class="ruby-node">&quot;#{CVS_BIN} -d #{root_url} rdiff -u -r#{identifier_to} -r#{identifier_from} #{shell_quote path_with_project}&quot;</span>
233:           <span class="ruby-identifier">diff</span> = []
234:           <span class="ruby-identifier">shellout</span>(<span class="ruby-identifier">cmd</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">io</span><span class="ruby-operator">|</span>
235:             <span class="ruby-identifier">io</span>.<span class="ruby-identifier">each_line</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">line</span><span class="ruby-operator">|</span>
236:               <span class="ruby-identifier">diff</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">line</span>
237:             <span class="ruby-keyword kw">end</span>
238:           <span class="ruby-keyword kw">end</span>
239:           <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">$?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">$?</span>.<span class="ruby-identifier">exitstatus</span> <span class="ruby-operator">!=</span> <span class="ruby-value">0</span>
240:           <span class="ruby-identifier">diff</span>
241:         <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000932" class="method-detail">
        <a name="M000932"></a>

        <div class="method-heading">
          <a href="#M000932" class="method-signature">
          <span class="method-name">entries</span><span class="method-args">(path=nil, identifier=nil)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns an <a href="Entries.html">Entries</a> collection or nil if the
given path doesn&#8216;t exist in the repository this method is used by the
repository-browser (aka LIST)
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000932-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000932-source">
<pre>
    <span class="ruby-comment cmt"># File lib/redmine/scm/adapters/cvs_adapter.rb, line 62</span>
62:         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">entries</span>(<span class="ruby-identifier">path</span>=<span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">identifier</span>=<span class="ruby-keyword kw">nil</span>)
63:           <span class="ruby-identifier">logger</span>.<span class="ruby-identifier">debug</span> <span class="ruby-node">&quot;&lt;cvs&gt; entries '#{path}' with identifier '#{identifier}'&quot;</span>
64:           <span class="ruby-identifier">path_with_project</span>=<span class="ruby-node">&quot;#{url}#{with_leading_slash(path)}&quot;</span>
65:           <span class="ruby-identifier">entries</span> = <span class="ruby-constant">Entries</span>.<span class="ruby-identifier">new</span>
66:           <span class="ruby-identifier">cmd</span> = <span class="ruby-node">&quot;#{CVS_BIN} -d #{root_url} rls -e&quot;</span>
67:           <span class="ruby-identifier">cmd</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot; -D \&quot;#{time_to_cvstime(identifier)}\&quot;&quot;</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">identifier</span>
68:           <span class="ruby-identifier">cmd</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot; #{shell_quote path_with_project}&quot;</span>
69:           <span class="ruby-identifier">shellout</span>(<span class="ruby-identifier">cmd</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">io</span><span class="ruby-operator">|</span>
70:             <span class="ruby-identifier">io</span>.<span class="ruby-identifier">each_line</span>(){<span class="ruby-operator">|</span><span class="ruby-identifier">line</span><span class="ruby-operator">|</span>
71:               <span class="ruby-identifier">fields</span>=<span class="ruby-identifier">line</span>.<span class="ruby-identifier">chop</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">'/'</span>,<span class="ruby-value">-1</span>)
72:               <span class="ruby-identifier">logger</span>.<span class="ruby-identifier">debug</span>(<span class="ruby-node">&quot;&gt;&gt;InspectLine #{fields.inspect}&quot;</span>)
73:               
74:               <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">fields</span>[<span class="ruby-value">0</span>]<span class="ruby-operator">!=</span><span class="ruby-value str">&quot;D&quot;</span>
75:                 <span class="ruby-identifier">entries</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-constant">Entry</span>.<span class="ruby-identifier">new</span>({<span class="ruby-identifier">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">fields</span>[<span class="ruby-value">-5</span>],
76:                   <span class="ruby-comment cmt">#:path =&gt; fields[-4].include?(path)?fields[-4]:(path + &quot;/&quot;+ fields[-4]),</span>
77:                   <span class="ruby-identifier">:path</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-node">&quot;#{path}/#{fields[-5]}&quot;</span>,
78:                   <span class="ruby-identifier">:kind</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'file'</span>,
79:                   <span class="ruby-identifier">:size</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">nil</span>,
80:                   <span class="ruby-identifier">:lastrev</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">Revision</span>.<span class="ruby-identifier">new</span>({
81:                     <span class="ruby-identifier">:revision</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">fields</span>[<span class="ruby-value">-4</span>],
82:                     <span class="ruby-identifier">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">fields</span>[<span class="ruby-value">-4</span>],
83:                     <span class="ruby-identifier">:time</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">Time</span>.<span class="ruby-identifier">parse</span>(<span class="ruby-identifier">fields</span>[<span class="ruby-value">-3</span>]),
84:                     <span class="ruby-identifier">:author</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">''</span>
85:                   })
86:                 })
87:               <span class="ruby-keyword kw">else</span>
88:                 <span class="ruby-identifier">entries</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-constant">Entry</span>.<span class="ruby-identifier">new</span>({<span class="ruby-identifier">:name</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">fields</span>[<span class="ruby-value">1</span>],
89:                   <span class="ruby-identifier">:path</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-node">&quot;#{path}/#{fields[1]}&quot;</span>,
90:                   <span class="ruby-identifier">:kind</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'dir'</span>,
91:                   <span class="ruby-identifier">:size</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">nil</span>,
92:                   <span class="ruby-identifier">:lastrev</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">nil</span>
93:                 })
94:               <span class="ruby-keyword kw">end</span>
95:             }
96:           <span class="ruby-keyword kw">end</span>
97:           <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">$?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">$?</span>.<span class="ruby-identifier">exitstatus</span> <span class="ruby-operator">!=</span> <span class="ruby-value">0</span>
98:           <span class="ruby-identifier">entries</span>.<span class="ruby-identifier">sort_by_name</span>
99:         <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000931" class="method-detail">
        <a name="M000931"></a>

        <div class="method-heading">
          <a href="#M000931" class="method-signature">
          <span class="method-name">get_previous_revision</span><span class="method-args">(revision)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000931-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000931-source">
<pre>
    <span class="ruby-comment cmt"># File lib/redmine/scm/adapters/cvs_adapter.rb, line 55</span>
55:         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">get_previous_revision</span>(<span class="ruby-identifier">revision</span>)
56:           <span class="ruby-constant">CvsRevisionHelper</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">revision</span>).<span class="ruby-identifier">prevRev</span>
57:         <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000930" class="method-detail">
        <a name="M000930"></a>

        <div class="method-heading">
          <a href="#M000930" class="method-signature">
          <span class="method-name">info</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000930-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000930-source">
<pre>
    <span class="ruby-comment cmt"># File lib/redmine/scm/adapters/cvs_adapter.rb, line 50</span>
50:         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">info</span>
51:           <span class="ruby-identifier">logger</span>.<span class="ruby-identifier">debug</span> <span class="ruby-value str">&quot;&lt;cvs&gt; info&quot;</span>
52:           <span class="ruby-constant">Info</span>.<span class="ruby-identifier">new</span>({<span class="ruby-identifier">:root_url</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@root_url</span>, <span class="ruby-identifier">:lastrev</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">nil</span>})
53:         <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000933" class="method-detail">
        <a name="M000933"></a>

        <div class="method-heading">
          <a href="#M000933" class="method-signature">
          <span class="method-name">revisions</span><span class="method-args">(path=nil, identifier_from=nil, identifier_to=nil, options={}) {|Revision.new({ :time =&gt; date, :author =&gt; author, :message=&gt;commit_log.chomp, :paths =&gt; [{ :revision =&gt; revision, :branch=&gt; revBranch, :path=&gt;entry_path, :name=&gt;entry_name, :kind=&gt;'file', :action=&gt;file_state| ...}</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Returns all <a href="CvsAdapter.html#M000933">revisions</a> found between
identifier_from and identifier_to in the repository. both identifier have
to be dates or nil. these method returns nothing but yield every result in
block
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000933-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000933-source">
<pre>
     <span class="ruby-comment cmt"># File lib/redmine/scm/adapters/cvs_adapter.rb, line 107</span>
107:         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">revisions</span>(<span class="ruby-identifier">path</span>=<span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">identifier_from</span>=<span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">identifier_to</span>=<span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">options</span>={}, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
108:           <span class="ruby-identifier">logger</span>.<span class="ruby-identifier">debug</span> <span class="ruby-node">&quot;&lt;cvs&gt; revisions path:'#{path}',identifier_from #{identifier_from}, identifier_to #{identifier_to}&quot;</span>
109:           
110:           <span class="ruby-identifier">path_with_project</span>=<span class="ruby-node">&quot;#{url}#{with_leading_slash(path)}&quot;</span>
111:           <span class="ruby-identifier">cmd</span> = <span class="ruby-node">&quot;#{CVS_BIN} -d #{root_url} rlog&quot;</span>
112:           <span class="ruby-identifier">cmd</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot; -d\&quot;&gt;#{time_to_cvstime(identifier_from)}\&quot;&quot;</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">identifier_from</span>
113:           <span class="ruby-identifier">cmd</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot; #{shell_quote path_with_project}&quot;</span>
114:           <span class="ruby-identifier">shellout</span>(<span class="ruby-identifier">cmd</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">io</span><span class="ruby-operator">|</span>
115:             <span class="ruby-identifier">state</span>=<span class="ruby-value str">&quot;entry_start&quot;</span>
116:             
117:             <span class="ruby-identifier">commit_log</span>=<span class="ruby-constant">String</span>.<span class="ruby-identifier">new</span>
118:             <span class="ruby-identifier">revision</span>=<span class="ruby-keyword kw">nil</span>
119:             <span class="ruby-identifier">date</span>=<span class="ruby-keyword kw">nil</span>
120:             <span class="ruby-identifier">author</span>=<span class="ruby-keyword kw">nil</span>
121:             <span class="ruby-identifier">entry_path</span>=<span class="ruby-keyword kw">nil</span>
122:             <span class="ruby-identifier">entry_name</span>=<span class="ruby-keyword kw">nil</span>
123:             <span class="ruby-identifier">file_state</span>=<span class="ruby-keyword kw">nil</span>
124:             <span class="ruby-identifier">branch_map</span>=<span class="ruby-keyword kw">nil</span>
125:             
126:             <span class="ruby-identifier">io</span>.<span class="ruby-identifier">each_line</span>() <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">line</span><span class="ruby-operator">|</span>            
127:               
128:               <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">state!</span>=<span class="ruby-value str">&quot;revision&quot;</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-node">/^#{ENDLOG}/</span> <span class="ruby-operator">=~</span> <span class="ruby-identifier">line</span>
129:                 <span class="ruby-identifier">commit_log</span>=<span class="ruby-constant">String</span>.<span class="ruby-identifier">new</span>
130:                 <span class="ruby-identifier">revision</span>=<span class="ruby-keyword kw">nil</span>
131:                 <span class="ruby-identifier">state</span>=<span class="ruby-value str">&quot;entry_start&quot;</span>
132:               <span class="ruby-keyword kw">end</span>
133:               
134:               <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">state</span><span class="ruby-operator">==</span><span class="ruby-value str">&quot;entry_start&quot;</span>
135:                 <span class="ruby-identifier">branch_map</span>=<span class="ruby-constant">Hash</span>.<span class="ruby-identifier">new</span>
136:                 <span class="ruby-keyword kw">if</span> <span class="ruby-node">/^RCS file: #{Regexp.escape(root_url_path)}\/#{Regexp.escape(path_with_project)}(.+),v$/</span> <span class="ruby-operator">=~</span> <span class="ruby-identifier">line</span>
137:                   <span class="ruby-identifier">entry_path</span> = <span class="ruby-identifier">normalize_cvs_path</span>(<span class="ruby-identifier">$1</span>)
138:                   <span class="ruby-identifier">entry_name</span> = <span class="ruby-identifier">normalize_path</span>(<span class="ruby-constant">File</span>.<span class="ruby-identifier">basename</span>(<span class="ruby-identifier">$1</span>))
139:                   <span class="ruby-identifier">logger</span>.<span class="ruby-identifier">debug</span>(<span class="ruby-node">&quot;Path #{entry_path} &lt;=&gt; Name #{entry_name}&quot;</span>)
140:                 <span class="ruby-keyword kw">elsif</span> <span class="ruby-regexp re">/^head: (.+)$/</span> <span class="ruby-operator">=~</span> <span class="ruby-identifier">line</span>
141:                   <span class="ruby-identifier">entry_headRev</span> = <span class="ruby-identifier">$1</span> <span class="ruby-comment cmt">#unless entry.nil?</span>
142:                 <span class="ruby-keyword kw">elsif</span> <span class="ruby-regexp re">/^symbolic names:/</span> <span class="ruby-operator">=~</span> <span class="ruby-identifier">line</span>
143:                   <span class="ruby-identifier">state</span>=<span class="ruby-value str">&quot;symbolic&quot;</span> <span class="ruby-comment cmt">#unless entry.nil?</span>
144:                 <span class="ruby-keyword kw">elsif</span> <span class="ruby-node">/^#{STARTLOG}/</span> <span class="ruby-operator">=~</span> <span class="ruby-identifier">line</span>
145:                   <span class="ruby-identifier">commit_log</span>=<span class="ruby-constant">String</span>.<span class="ruby-identifier">new</span>
146:                   <span class="ruby-identifier">state</span>=<span class="ruby-value str">&quot;revision&quot;</span>
147:                 <span class="ruby-keyword kw">end</span>  
148:                 <span class="ruby-keyword kw">next</span>
149:               <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">state</span><span class="ruby-operator">==</span><span class="ruby-value str">&quot;symbolic&quot;</span>
150:                 <span class="ruby-keyword kw">if</span> <span class="ruby-regexp re">/^(.*):\s(.*)/</span> <span class="ruby-operator">=~</span> (<span class="ruby-identifier">line</span>.<span class="ruby-identifier">strip</span>) 
151:                   <span class="ruby-identifier">branch_map</span>[<span class="ruby-identifier">$1</span>]=<span class="ruby-identifier">$2</span>
152:                 <span class="ruby-keyword kw">else</span>
153:                   <span class="ruby-identifier">state</span>=<span class="ruby-value str">&quot;tags&quot;</span>
154:                   <span class="ruby-keyword kw">next</span>
155:                 <span class="ruby-keyword kw">end</span>          
156:               <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">state</span><span class="ruby-operator">==</span><span class="ruby-value str">&quot;tags&quot;</span>
157:                 <span class="ruby-keyword kw">if</span> <span class="ruby-node">/^#{STARTLOG}/</span> <span class="ruby-operator">=~</span> <span class="ruby-identifier">line</span>
158:                   <span class="ruby-identifier">commit_log</span> = <span class="ruby-value str">&quot;&quot;</span>
159:                   <span class="ruby-identifier">state</span>=<span class="ruby-value str">&quot;revision&quot;</span>
160:                 <span class="ruby-keyword kw">elsif</span> <span class="ruby-node">/^#{ENDLOG}/</span> <span class="ruby-operator">=~</span> <span class="ruby-identifier">line</span>
161:                   <span class="ruby-identifier">state</span>=<span class="ruby-value str">&quot;head&quot;</span>
162:                 <span class="ruby-keyword kw">end</span>
163:                 <span class="ruby-keyword kw">next</span>
164:               <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">state</span><span class="ruby-operator">==</span><span class="ruby-value str">&quot;revision&quot;</span>
165:                 <span class="ruby-keyword kw">if</span> <span class="ruby-node">/^#{ENDLOG}/</span> <span class="ruby-operator">=~</span> <span class="ruby-identifier">line</span> <span class="ruby-operator">||</span> <span class="ruby-node">/^#{STARTLOG}/</span> <span class="ruby-operator">=~</span> <span class="ruby-identifier">line</span>               
166:                   <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">revision</span>
167:                     
168:                     <span class="ruby-identifier">revHelper</span>=<span class="ruby-constant">CvsRevisionHelper</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">revision</span>)
169:                     <span class="ruby-identifier">revBranch</span>=<span class="ruby-value str">&quot;HEAD&quot;</span>
170:                     
171:                     <span class="ruby-identifier">branch_map</span>.<span class="ruby-identifier">each</span>() <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">branch_name</span>,<span class="ruby-identifier">branch_point</span><span class="ruby-operator">|</span>
172:                       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">revHelper</span>.<span class="ruby-identifier">is_in_branch_with_symbol</span>(<span class="ruby-identifier">branch_point</span>)
173:                         <span class="ruby-identifier">revBranch</span>=<span class="ruby-identifier">branch_name</span>
174:                       <span class="ruby-keyword kw">end</span>
175:                     <span class="ruby-keyword kw">end</span>
176:                     
177:                     <span class="ruby-identifier">logger</span>.<span class="ruby-identifier">debug</span>(<span class="ruby-node">&quot;********** YIELD Revision #{revision}::#{revBranch}&quot;</span>)
178:                     
179:                     <span class="ruby-keyword kw">yield</span> <span class="ruby-constant">Revision</span>.<span class="ruby-identifier">new</span>({                    
180:                       <span class="ruby-identifier">:time</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">date</span>,
181:                       <span class="ruby-identifier">:author</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">author</span>,
182:                       <span class="ruby-identifier">:message=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">commit_log</span>.<span class="ruby-identifier">chomp</span>,
183:                       <span class="ruby-identifier">:paths</span> =<span class="ruby-operator">&gt;</span> [{
184:                         <span class="ruby-identifier">:revision</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">revision</span>,
185:                         <span class="ruby-identifier">:branch=</span><span class="ruby-operator">&gt;</span> <span class="ruby-identifier">revBranch</span>,
186:                         <span class="ruby-identifier">:path=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">entry_path</span>,
187:                         <span class="ruby-identifier">:name=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">entry_name</span>,
188:                         <span class="ruby-identifier">:kind=</span><span class="ruby-operator">&gt;</span><span class="ruby-value str">'file'</span>,
189:                         <span class="ruby-identifier">:action=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">file_state</span>
190:                       }]
191:                     })                 
192:                   <span class="ruby-keyword kw">end</span>
193:     
194:                   <span class="ruby-identifier">commit_log</span>=<span class="ruby-constant">String</span>.<span class="ruby-identifier">new</span>
195:                   <span class="ruby-identifier">revision</span>=<span class="ruby-keyword kw">nil</span>
196:                   
197:                   <span class="ruby-keyword kw">if</span> <span class="ruby-node">/^#{ENDLOG}/</span> <span class="ruby-operator">=~</span> <span class="ruby-identifier">line</span>
198:                     <span class="ruby-identifier">state</span>=<span class="ruby-value str">&quot;entry_start&quot;</span>
199:                   <span class="ruby-keyword kw">end</span>
200:                   <span class="ruby-keyword kw">next</span>
201:                 <span class="ruby-keyword kw">end</span>
202:                   
203:                 <span class="ruby-keyword kw">if</span> <span class="ruby-regexp re">/^branches: (.+)$/</span> <span class="ruby-operator">=~</span> <span class="ruby-identifier">line</span>
204:                   <span class="ruby-comment cmt">#TODO: version.branch = $1</span>
205:                 <span class="ruby-keyword kw">elsif</span> <span class="ruby-regexp re">/^revision (\d+(?:\.\d+)+).*$/</span> <span class="ruby-operator">=~</span> <span class="ruby-identifier">line</span>
206:                   <span class="ruby-identifier">revision</span> = <span class="ruby-identifier">$1</span>   
207:                 <span class="ruby-keyword kw">elsif</span> <span class="ruby-regexp re">/^date:\s+(\d+.\d+.\d+\s+\d+:\d+:\d+)/</span> <span class="ruby-operator">=~</span> <span class="ruby-identifier">line</span>
208:                   <span class="ruby-identifier">date</span>      = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">parse</span>(<span class="ruby-identifier">$1</span>)
209:                   <span class="ruby-identifier">author</span>    = <span class="ruby-regexp re">/author: ([^;]+)/</span>.<span class="ruby-identifier">match</span>(<span class="ruby-identifier">line</span>)[<span class="ruby-value">1</span>]
210:                   <span class="ruby-identifier">file_state</span>     = <span class="ruby-regexp re">/state: ([^;]+)/</span>.<span class="ruby-identifier">match</span>(<span class="ruby-identifier">line</span>)[<span class="ruby-value">1</span>]
211:                   <span class="ruby-comment cmt">#TODO: linechanges only available in CVS.... maybe a feature our SVN implementation. i'm sure, they are</span>
212:                   <span class="ruby-comment cmt">#    useful for stats or something else</span>
213:                   <span class="ruby-comment cmt">#                linechanges =/lines: \+(\d+) -(\d+)/.match(line)</span>
214:                   <span class="ruby-comment cmt">#                unless linechanges.nil?</span>
215:                   <span class="ruby-comment cmt">#                  version.line_plus  = linechanges[1]</span>
216:                   <span class="ruby-comment cmt">#                  version.line_minus = linechanges[2]</span>
217:                   <span class="ruby-comment cmt">#                else</span>
218:                   <span class="ruby-comment cmt">#                  version.line_plus  = 0</span>
219:                   <span class="ruby-comment cmt">#                  version.line_minus = 0     </span>
220:                   <span class="ruby-comment cmt">#                end              </span>
221:                 <span class="ruby-keyword kw">else</span>            
222:                   <span class="ruby-identifier">commit_log</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">line</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">line</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/^\*\*\* empty log message \*\*\*/</span>
223:                 <span class="ruby-keyword kw">end</span> 
224:               <span class="ruby-keyword kw">end</span> 
225:             <span class="ruby-keyword kw">end</span>
226:           <span class="ruby-keyword kw">end</span>
227:         <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000928" class="method-detail">
        <a name="M000928"></a>

        <div class="method-heading">
          <a href="#M000928" class="method-signature">
          <span class="method-name">root_url</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000928-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000928-source">
<pre>
    <span class="ruby-comment cmt"># File lib/redmine/scm/adapters/cvs_adapter.rb, line 42</span>
42:         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">root_url</span>
43:           <span class="ruby-ivar">@root_url</span>
44:         <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000929" class="method-detail">
        <a name="M000929"></a>

        <div class="method-heading">
          <a href="#M000929" class="method-signature">
          <span class="method-name">url</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000929-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000929-source">
<pre>
    <span class="ruby-comment cmt"># File lib/redmine/scm/adapters/cvs_adapter.rb, line 46</span>
46:         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">url</span>
47:           <span class="ruby-ivar">@url</span>
48:         <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>


    </div>


  </div>


<div id="validator-badges">
  <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
</div>

</body>
</html>